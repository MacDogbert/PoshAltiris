<!--
SYMANTEC:     Copyright (c) 2016 Symantec Corporation. All rights reserved.

THIS SOFTWARE CONTAINS CONFIDENTIAL INFORMATION AND TRADE SECRETS OF SYMANTEC CORPORATION. USE, 
DISCLOSURE OR REPRODUCTION IS PROHIBITED WITHOUT THE PRIOR EXPRESS WRITTEN PERMISSION OF SYMANTEC
CORPORATION.

The Licensed Software and Documentation are deemed to be commercial computer software as defined
in FAR 12.212 and subject to restricted rights as defined in FAR Section 52.227-19 "Commercial
Computer Software - Restricted Rights" and DFARS 227.7202, Rights in "Commercial Computer Software
or Commercial Computer Software Documentation", as applicable, and any successor regulations,
whether delivered by Symantec as on premises or hosted services.  Any use, modification, reproduction
release, performance, display or disclosure of the Licensed Software and Documentation by the U.S.
Government shall be solely in accordance with the terms of this Agreement.
-->

<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Setting Up ASDK COM Objects</title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><xml><MSHelp:Keyword Index="A" Term="2e17f41d-7657-4d92-b064-112be487fd3c" /><MSHelp:Attr Name="RevisionNumber" Value="1" /><MSHelp:Attr Name="AssetID" Value="2e17f41d-7657-4d92-b064-112be487fd3c" /><MSHelp:Attr Name="Abstract" Value="&#xD;&#xA;        To use the COM layer of the ASDK, you must first set up the COM object you want to use. To set up a&#xD;&#xA;        COM object, do the following:&#xD;&#xA;        &#xD;&#xA;          &#xD;&#xA;            Create the COM object.&#xD;&#xA;          &#xD;&#xA;          &#xD;&#xA;            Establ ..." /><MSHelp:Attr Name="TopicType" Value="kbArticle" /><MSHelp:Attr Name="Locale" Value="en-us" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"></script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Symantec Administrator SDK 8.0</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Setting Up ASDK COM Objects</span></td></tr><tr id="headerTableRow3"><td align="left">
  <span id="headfeedbackarea" class="feedbackhead">
      <a href="javascript:SubmitFeedback('DL-AL-SDKSupport@symantec.com','Symantec Administrator SDK 8.0','','1.0.0.0','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">
        
        Send Feedback
      </a>
	</span>
</td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"> </span>
  

    <div class="introduction">
      <p>
        To use the COM layer of the ASDK, you must first set up the COM object you want to use. To set up a
        COM object, do the following:
        <ul><li>
            Create the COM object.
          </li><li>
            Establish a connection to the corresponding Web service or bypass the Web service by
            instantiating the assembly locally.
          </li></ul>
      </p>
      <p>
        For more information about the layers of the ASDK, see 
        <span sdata="link"><a href="4a921e38-3368-47d8-b74e-2e59b771200f.htm#How Is It Built?">How Is It Built?</a></span> in 
        <span sdata="link"><span class="nolink">Getting Started with the ASDK</span></span>.
      </p>
      
    </div>

    <a name="Section1" /><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0, event)" tabindex="0"><img id="sectionToggle0" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Creating the Object</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style="">
        <p>
          To create the object, you call <span class="code">CreateObject()</span> using the correct
          <span sdata="link"><a href="6bdd02c4-cfc4-487c-9c8d-ff4b3b9eb868.htm">Program Id</a></span>. For example, to create
          the ItemManagement object you use this line of code:

          <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VBScript</div><div class="code"><pre><span class="highlight-keyword">set</span> itemManagement = <span class="highlight-keyword">CreateObject</span>(<span class="highlight-literal">"Altiris.ASDK.NS.ItemManagement"</span>)</pre></div></span>
          <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>JavaScript</div><div class="code"><pre>itemManagement = WScript.CreateObject(<span class="highlight-literal">"Altiris.ASDK.NS.ItemManagement"</span>);</pre></div></span>
          
        </p>
      </div>
    
    <a name="Section2" /><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1, event)" tabindex="0"><img id="sectionToggle1" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Establishing a Connection</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style="">
        <p>
          The following discussion and sample code show <span class="code">UserName</span> and
          <span class="code">Password</span> values being stored directly in the VBScript file; this is for
          purposes of brevity and clarity only.
        </p>
        <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" title="Important note" src="../icons/alert_caution.gif" /><b>Important Note:</b></th></tr><tr><td>
          <p>
            Symantec recommends that you set up your script to accept the <span class="code">UserName</span>
            and <span class="code">Password</span> values from a pop-up dialog at the time the script
            is run rather than hard-coding these values inside the script. Here is an example of how to do
            this in your VBScript, using the itemManagement object:
            
            <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VBScript</div><div class="code"><pre>itemManagement.UserName = <span class="highlight-keyword">InputBox</span>(<span class="highlight-literal">"Enter a user as DOMAIN\User"</span>, <span class="highlight-literal">"SomeMethodName"</span>)
itemManagement.Password = <span class="highlight-keyword">InputBox</span>(<span class="highlight-literal">"Enter password"</span>, <span class="highlight-literal">"SomeMethodName"</span>)</pre></div></span>
            
          </p>
        </td></tr></table></div>
        <p>
          If you will be running your COM application from a different machine than your Notification
          Server (NS), you must connect to the Web service to allow remote access. If your COM application
          will be running on the same machine as your NS server, then you can choose to either make a local
          Web service connection or bypass the Web service completely. To bypass the Web service layer, see
          the next section (which presents information about both local and remote Web service connections).
        </p>
        <p>
          <ol><li>
              <p>
                The first step in making a Web service connection is to set your credential information.
              </p>
              <p>
                You can specify the target server (the box hosting NS) and the target server's username,
                password, and domain. Only the target server is required. If username, password, and domain
                are not used, then the currently logged-on user's account is used. To make a local web service
                connection, you should set the target server to <span class="input">localhost</span>.
              </p>
              <p>
                For example, using the ItemManagement object created above, you could connect to a remote
                machine using full credential information with the following code:
                
                <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VBScript</div><div class="code"><pre>itemManagement.TargetServer = <span class="highlight-literal">"machinename"</span>
itemManagement.UserName = <span class="highlight-literal">"username"</span>
itemManagement.Password = <span class="highlight-literal">"password"</span>
itemManagement.DomainName = <span class="highlight-literal">"domain"</span></pre></div></span>
                <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>JavaScript</div><div class="code"><pre>itemManagement.TargetServer = <span class="highlight-literal">"machinename"</span>;
itemManagement.UserName = <span class="highlight-literal">"username"</span>;
itemManagement.Password = <span class="highlight-literal">"password"</span>;
itemManagement.DomainName = <span class="highlight-literal">"domain"</span>;</pre></div></span>
                
              </p>
              <p>
                Alternatively, you could connect to the local machine using full credential information with
                the same code shown above, except that you would replace <span class="input">machinename</span>
                with <span class="input">localhost</span>. When connecting to the local machine, supplying the
                Target Server is all that is necessary.
              </p>
              <p>
                Remember, for any http connection, only the Target Server is required.
                You only need to supply User Name and Password if the logged-on user does not have permission
                to access the remote machine. Also, you only need to supply a Domain Name if connecting to a
                machine on a different domain.
              </p>
              <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" title="Note" src="../icons/alert_note.gif" /><b>Note:</b></th></tr><tr><td>
                <p>
                  If you have configured your Web server to use the more secure HTTPS (SSL)
                  protocol instead of HTTP, then you must set an additional property called
                  <span class="code">Protocol</span>. In that case, set <span class="code">Protocol</span> to <span class="input">HTTPS</span>.
                  There is also a property called <span class="code">Port</span> that can be set to the Web server
                  port that will handle the HTTPS connection. If you do not set the <span class="code">Port</span>
                  property for an HTTPS connection, it will default to 443.
                  Here is an example:

                  <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VBScript</div><div class="code"><pre>itemManagement.Protocol = <span class="highlight-literal">"HTTPS"</span>
itemManagement.Port = <span class="highlight-literal">"443"</span></pre></div></span>
                  <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>JavaScript</div><div class="code"><pre>itemManagement.Protocol = <span class="highlight-literal">"HTTPS"</span>;
itemManagement.Port = <span class="highlight-literal">"443"</span>;</pre></div></span>

                </p>
                <p>
                  If your Web server is configured to use HTTP only, you do not need to set the
                  <span class="code">Protocol</span> or <span class="code">Port</span> properties (assuming that your
                  Web server is using the standard HTTP port 80).
                </p>
              </td></tr></table></div>
            </li><li>
              <p>
                After you have established the correct credential information, you must call <span class="code">Athenticate()</span>.
              </p>
              <p>
                The <span class="code">Authenticate()</span> call sets up the correct URL based on the Target Server
                name you supplied and passes the other credential information you supplied to the Web service in
                order to gain access. Again, using the already created ItemManagement object, the code looks like this:
                
                <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VBScript</div><div class="code"><pre>itemManagement.Authenticate()</pre></div></span>
                <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>JavaScript</div><div class="code"><pre>itemManagement.Authenticate();</pre></div></span>
                
              </p>
            </li></ol>
        </p>
      </div>

    <a name="Section3" /><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle2)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle2, event)" tabindex="0"><img id="sectionToggle2" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Adjusting the Time-Out Value</span></h1><div id="sectionSection2" class="section" name="collapseableSection" style="">
        <p>
          Time-out is the length of time the application is set to wait before abandoning a task. Using
          the <span class="code">SetTimeOut()</span> method you can adjust the time out value to any length
          of time (in milliseconds) necessary. The default time-out setting is 100000 milliseconds
          (1.67 minutes). To make the time-out an infinite length, set the value to <span class="input">-1</span>
          (negative-one). Note that the <span class="code">SetTimeOut()</span> method only applies when the
          COM object is using the Web service to connect to the server. If you try to call <span class="code">SetTimeOut()</span>
          when connected directly to the server assembly using <span class="code">CreateLocalInstance()</span> (see below),
          an exception will be thrown.
          
          <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VBScript</div><div class="code"><pre>itemManagement.SetTimeOut(<span class="highlight-number">180000</span>) <span class="highlight-comment">'change to 3 minutes</span></pre></div></span>
          <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>JavaScript</div><div class="code"><pre>itemManagement.SetTimeOut(<span class="highlight-number">180000</span>); <span class="highlight-comment">//change to 3 minutes</span></pre></div></span>

        </p>
      </div>

    <a name="Section4" /><h1 class="heading"><span onclick="ExpandCollapse(sectionToggle3)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle3, event)" tabindex="0"><img id="sectionToggle3" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Bypass the Web Service</span></h1><div id="sectionSection3" class="section" name="collapseableSection" style="">
        <p>
          If the Notification Server is on the same machine as your COM object, you have the option of bypassing
          the Web service layer. This method can provide improved speed but may require additional configuration.
        </p>
        <p>
          You bypass the Web service layer by creating a local instance of the corresponding ASDK assembly.
          This assembly is stored in the GAC on the server machine and is loaded using Reflection. To create a
          local instance of the ASDK assembly, call <span class="code">CreateLocalInstance()</span>; do not call
          <span class="code">Authenticate()</span>.
        </p>
        <p>
          For example, to create a local instance of the ItemManagement object created in step 1, use this code:
        
          <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VBScript</div><div class="code"><pre>itemManagement.CreateLocalInstance()</pre></div></span>
          <span><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>JavaScript</div><div class="code"><pre>itemManagement.CreateLocalInstance();</pre></div></span>

        </p>
      </div>

  
</div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss" style="display: none;"> </span>
<p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:DL-AL-SDKSupport%40symantec.com?Subject=Symantec Administrator SDK 8.0">DL-AL-SDKSupport@symantec.com</a>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> <p />Copyright © 2016, Symantec Corporation, All rights reserved</div></div></body></html>
