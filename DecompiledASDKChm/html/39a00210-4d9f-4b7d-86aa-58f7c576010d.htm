<!--
SYMANTEC:     Copyright (c) 2016 Symantec Corporation. All rights reserved.

THIS SOFTWARE CONTAINS CONFIDENTIAL INFORMATION AND TRADE SECRETS OF SYMANTEC CORPORATION. USE, 
DISCLOSURE OR REPRODUCTION IS PROHIBITED WITHOUT THE PRIOR EXPRESS WRITTEN PERMISSION OF SYMANTEC
CORPORATION.

The Licensed Software and Documentation are deemed to be commercial computer software as defined
in FAR 12.212 and subject to restricted rights as defined in FAR Section 52.227-19 "Commercial
Computer Software - Restricted Rights" and DFARS 227.7202, Rights in "Commercial Computer Software
or Commercial Computer Software Documentation", as applicable, and any successor regulations,
whether delivered by Symantec as on premises or hosted services.  Any use, modification, reproduction
release, performance, display or disclosure of the Licensed Software and Documentation by the U.S.
Government shall be solely in accordance with the terms of this Agreement.
-->

<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Creating and Using Proxy Classes</title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><xml><MSHelp:Keyword Index="A" Term="39a00210-4d9f-4b7d-86aa-58f7c576010d" /><MSHelp:Attr Name="RevisionNumber" Value="1" /><MSHelp:Attr Name="AssetID" Value="39a00210-4d9f-4b7d-86aa-58f7c576010d" /><MSHelp:Attr Name="Abstract" Value="&#xD;&#xA;        Proxy classes in .NET programming handle the lower-level formatting and transmission of Web service&#xD;&#xA;        calls.  Proxy classes can be created using the Microsoft wsdl tool. This tool&#xD;&#xA;        generates C# code that encapsulates access t ..." /><MSHelp:Attr Name="TopicType" Value="kbArticle" /><MSHelp:Attr Name="Locale" Value="en-us" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"></script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Symantec Administrator SDK 8.0</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Creating and Using Proxy Classes</span></td></tr><tr id="headerTableRow3"><td align="left">
  <span id="headfeedbackarea" class="feedbackhead">
      <a href="javascript:SubmitFeedback('DL-AL-SDKSupport@symantec.com','Symantec Administrator SDK 8.0','','1.0.0.0','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">
        
        Send Feedback
      </a>
	</span>
</td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"> </span>
  

    <div class="introduction">
      <p>
        Proxy classes in .NET programming handle the lower-level formatting and transmission of Web service
        calls.  Proxy classes can be created using the Microsoft wsdl tool. This tool
        generates C# code that encapsulates access to the web service. For more information about how to use
        the wsdl tool from the command line, or about how to create proxy classes
        using Visual Studio, see this
          <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rsprog/htm/rsp_prog_soapapi_dev_57fm.asp.">MSDN article</a>.
      </p>
      <p>
        <ol><li>
              Make sure that the Web service is installed on a machine that you have access to. In the
              case of the NS ASDK component, for example, the installation package (Symantec_ASDK_NS_Server_x86.msi
              or Symantec_ASDK_NS_Server_x64.msi), which is run by the Symantec Installation Manager [SIM] utility,
              will install the Altiris/ASDK.NS web service.
          </li><li>
              Open a Visual Studio command prompt. (Navigate to
              <span class="ui">
                Start &gt; All Programs &gt; Microsoft Visual Studio 2005 &gt; Visual Studio Tools &gt; Visual Studio 2005 Command Prompt
              </span>.)
          </li><li>
            Navigate to the folder where you want the proxy classes to be created.
          </li><li>
            <p>
              At the prompt, enter the following: wsdl /language:CS &lt;web service location&gt;
            </p>
            <p>
              For example, to create a proxy class for ItemManagementService installed on your local machine, enter this line:
              <blockQuote>
                wsdl /language:CS http://localhost/Altiris/ASDK.NS/ItemManagementService.asmx
              </blockQuote>
            </p>
          </li><li>
            Include the generated code file in your project.
          </li><li>
            Add a reference in your project to System.Web.Services. Then, add the following statements to your code:
            <blockQuote>
              <span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre><span class="highlight-keyword">using</span> System.Net;
<span class="highlight-keyword">using</span> System.Web.Services;</pre></div></span>
            </blockQuote>
          </li><li>
            Create an object of the Web service. For example, to create an ItemManagementService object, use this code:
            <blockQuote>
              <span id="cbc_2" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre>ItemManagementService itemMS = <span class="highlight-keyword">new</span> ItemManagementService();</pre></div></span>
            </blockQuote>
          </li><li>
            Update the Credentials for authorization to the Web service. For example, use this code:
            <blockQuote>
              <span id="cbc_3" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre>itemMS.Credentials = CredentialCache.DefaultCredentials</pre></div></span>
            </blockQuote>
            For more information about setting credentials, see the 
            <span sdata="link"><a href="57fca8b2-e763-4a3e-8665-5f5641c10aeb.htm">Credentials</a></span> page.
          </li><li>
            If you want to change the default timeout setting for the connection to the Web server, set the value
            of the <span class="code">Timeout</span> property of the service object. (The default time-out setting
            is 100000 milliseconds (1.67 minutes).) Use a number representing milliseconds to set a new value. To
            make the time-out an infinite length set the value to -1. For example, use this code to set the timeout
            to 5 minutes:
            <blockQuote>
              <span id="cbc_4" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre>itemMS.Timeout = <span class="highlight-number">300000</span>;</pre></div></span>
            </blockQuote>
            <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" title="Note" src="../icons/alert_note.gif" /><b>Note:</b></th></tr><tr><td>
              Conflicts may occur between proxy classes. For instance, if you create proxy classes for
              ItemManagementService and CollectionManagementService, a conflict will occur because <span class="code">ItemDetails</span>
              will be defined multiple times. You can resolve such conflicts by modifying the proxy class code.
              In this example, you should delete the <span class="code">ItemDetails</span> class from one of the two files.
            </td></tr></table></div>
          </li><li>
            The standard methods provided are used to make synchronous calls to the Web service. The proxy class
            has <span class="code">Begin</span> and <span class="code">End</span> methods associated with each standard
            method, which are used to make asynchronous calls to the Web service. For example, when using
            ItemManagementService, you will see the methods <span class="code">BeginCloneItem()</span>,
            <span class="code">EndCloneItem()</span> and <span class="code">CloneItem()</span>; Use the
            <span class="code">CloneItem()</span> method to perform a synchronous operation, and use the
            <span class="code">BeginCloneItem()</span> and <span class="code">EndCloneItem()</span> to perform
            an asynchronous operation.
          </li></ol>
      </p>
    </div>

  
</div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss" style="display: none;"> </span>
<p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:DL-AL-SDKSupport%40symantec.com?Subject=Symantec Administrator SDK 8.0">DL-AL-SDKSupport@symantec.com</a>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> <p />Copyright © 2016, Symantec Corporation, All rights reserved</div></div></body></html>
